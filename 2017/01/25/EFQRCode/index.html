<!DOCTYPE html>


  <html class="light page-post">


<head>
  <meta charset="utf-8">
  
  <title>iOS 花式二维码生成和二维码识别 | 荏苒。</title>

  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  
    <meta name="keywords" content="QRCode," />
  

  <meta name="description" content="iOS 原生的二维码识别非常之棒，反正比 ZXing 和 ZBar 效果都好些，所以以后打算尽量用原生的二维码识别，然后最近把原生的二维码生成也顺便做了一遍，并且在原有基础上加了一些样式参数，封了一个小库方便以后使用。 项目地址：https://github.com/EyreFree/EFQRCode   EFQRCode 是一个用 Swift 编写的用来生成和识别二维码的库，它基于系统二维码生成">
<meta name="keywords" content="QRCode">
<meta property="og:type" content="article">
<meta property="og:title" content="iOS 花式二维码生成和二维码识别">
<meta property="og:url" content="http://www.eyrefree.org/2017/01/25/EFQRCode/index.html">
<meta property="og:site_name" content="荏苒。">
<meta property="og:description" content="iOS 原生的二维码识别非常之棒，反正比 ZXing 和 ZBar 效果都好些，所以以后打算尽量用原生的二维码识别，然后最近把原生的二维码生成也顺便做了一遍，并且在原有基础上加了一些样式参数，封了一个小库方便以后使用。 项目地址：https://github.com/EyreFree/EFQRCode   EFQRCode 是一个用 Swift 编写的用来生成和识别二维码的库，它基于系统二维码生成">
<meta property="og:image" content="https://raw.githubusercontent.com/EyreFree/EFQRCode/master/assets/EFQRCode.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/EyreFree/EFQRCode/master/assets/QRCode1.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/EyreFree/EFQRCode/master/assets/QRCode2.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/EyreFree/EFQRCode/master/assets/QRCode3.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/EyreFree/EFQRCode/master/assets/QRCode4.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/EyreFree/EFQRCode/master/assets/QRCode5.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/EyreFree/EFQRCode/master/assets/QRCode6.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/EyreFree/EFQRCode/master/assets/QRCode7.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/EyreFree/EFQRCode/master/assets/QRCode8.jpg">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/1018190-7579f281bbd2d0fd.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:updated_time" content="2018-01-21T16:01:16.984Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="iOS 花式二维码生成和二维码识别">
<meta name="twitter:description" content="iOS 原生的二维码识别非常之棒，反正比 ZXing 和 ZBar 效果都好些，所以以后打算尽量用原生的二维码识别，然后最近把原生的二维码生成也顺便做了一遍，并且在原有基础上加了一些样式参数，封了一个小库方便以后使用。 项目地址：https://github.com/EyreFree/EFQRCode   EFQRCode 是一个用 Swift 编写的用来生成和识别二维码的库，它基于系统二维码生成">
<meta name="twitter:image" content="https://raw.githubusercontent.com/EyreFree/EFQRCode/master/assets/EFQRCode.jpg">

  

  
    <link rel="icon" href="/favicon.ico">
  

  <link href="/css/styles.css?v=c114cbe6" rel="stylesheet">


  
    <link rel="stylesheet" href="/css/personal-style.css">
  

  

  
  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?638f7245dab1e13e3d8fbdd9cc3b0895";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>


  
  <script type="text/javascript">
	(function(){
	    var bp = document.createElement('script');
	    var curProtocol = window.location.protocol.split(':')[0];
	    if (curProtocol === 'https') {
	        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
	    }
	    else {
	        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
	    }
	    var s = document.getElementsByTagName("script")[0];
	    s.parentNode.insertBefore(bp, s);
	})();
  </script>



  
    <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>
  

  
    <link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.3.0/css/font-awesome.min.css">
  
</head>

<body>


  
    <span id="toolbox-mobile" class="toolbox-mobile">盒子</span>
  

  <div class="post-header CENTER">
   
  <div class="toolbox">
    <a class="toolbox-entry" href="/">
      <span class="toolbox-entry-text">盒子</span>
      <i class="icon-angle-down"></i>
      <i class="icon-home"></i>
    </a>
    <ul class="list-toolbox">
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/archives/"
            rel="noopener noreferrer"
            target="_self"
            >
            博客
          </a>
        </li>
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/category/"
            rel="noopener noreferrer"
            target="_self"
            >
            分类
          </a>
        </li>
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/tag/"
            rel="noopener noreferrer"
            target="_self"
            >
            标签
          </a>
        </li>
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/project/"
            rel="noopener noreferrer"
            target="_self"
            >
            项目
          </a>
        </li>
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/link/"
            rel="noopener noreferrer"
            target="_self"
            >
            友链
          </a>
        </li>
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/about/"
            rel="noopener noreferrer"
            target="_self"
            >
            关于
          </a>
        </li>
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/atom.xml"
            rel="noopener noreferrer"
            target="_blank"
            >
            RSS
          </a>
        </li>
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/search/"
            rel="noopener noreferrer"
            target="_self"
            >
            搜索
          </a>
        </li>
      
    </ul>
  </div>


</div>


  <div id="toc" class="toc-article">
    <strong class="toc-title">文章目录</strong>
    <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#一-效果预览"><span class="toc-text">一. 效果预览</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#二-示例"><span class="toc-text">二. 示例</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#三-环境"><span class="toc-text">三. 环境</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#四-安装"><span class="toc-text">四. 安装</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#五-快速使用"><span class="toc-text">五. 快速使用</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-导入-EFQRCode"><span class="toc-text">1. 导入 EFQRCode</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-二维码识别"><span class="toc-text">2. 二维码识别</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-二维码生成"><span class="toc-text">3. 二维码生成</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#六-使用指南"><span class="toc-text">六. 使用指南</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#七-备注"><span class="toc-text">七. 备注</span></a></li></ol>
  </div>



<div class="content content-post CENTER">
   <article id="post-EFQRCode" class="article article-type-post" itemprop="blogPost">
  <header class="article-header">
    <h1 class="post-title">iOS 花式二维码生成和二维码识别</h1>

    <div class="article-meta">
      <span>
        <i class="icon-calendar"></i>
        <span>2017.01.25</span>
      </span>

      
        <span class="article-author">
          <i class="icon-user"></i>
          <span>EyreFree</span>
        </span>
      

      
  <span class="article-category">
    <i class="icon-list"></i>
    <a class="article-category-link" href="/categories/iOS/">iOS</a>
  </span>



      

      
      <i class="fa fa-eye"></i> 
        <span id="busuanzi_container_page_pv">
           &nbsp热度 <span id="busuanzi_value_page_pv">
           <i class="fa fa-spinner fa-spin"></i></span>℃
        </span>
      
      
    </div>
  </header>

  <div class="article-content">
    
      <p>iOS 原生的二维码识别非常之棒，反正比 ZXing 和 ZBar 效果都好些，所以以后打算尽量用原生的二维码识别，然后最近把原生的二维码生成也顺便做了一遍，并且在原有基础上加了一些样式参数，封了一个小库方便以后使用。</p>
<p>项目地址：<a href="https://github.com/EyreFree/EFQRCode" target="_blank" rel="noopener">https://github.com/EyreFree/EFQRCode</a></p>
<hr>
<p><img src="https://raw.githubusercontent.com/EyreFree/EFQRCode/master/assets/EFQRCode.jpg" alt=""></p>
<p>EFQRCode 是一个用 Swift 编写的用来生成和识别二维码的库，它基于系统二维码生成与识别进行开发。</p>
<ul>
<li>生成：利用输入的水印图/图标等资源生成各种艺术二维码；</li>
<li>识别：识别率比 iOS 原生二维码识别率更高。</li>
</ul>
<h2 id="一-效果预览"><a href="#一-效果预览" class="headerlink" title="一. 效果预览"></a>一. 效果预览</h2><table>
<thead>
<tr>
<th style="text-align:center"><img src="https://raw.githubusercontent.com/EyreFree/EFQRCode/master/assets/QRCode1.jpg" alt=""></th>
<th style="text-align:center"><img src="https://raw.githubusercontent.com/EyreFree/EFQRCode/master/assets/QRCode2.jpg" alt=""></th>
<th style="text-align:center"><img src="https://raw.githubusercontent.com/EyreFree/EFQRCode/master/assets/QRCode3.jpg" alt=""></th>
<th style="text-align:center"><img src="https://raw.githubusercontent.com/EyreFree/EFQRCode/master/assets/QRCode4.jpg" alt="">  </th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><img src="https://raw.githubusercontent.com/EyreFree/EFQRCode/master/assets/QRCode5.jpg" alt=""></td>
<td style="text-align:center"><img src="https://raw.githubusercontent.com/EyreFree/EFQRCode/master/assets/QRCode6.jpg" alt=""></td>
<td style="text-align:center"><img src="https://raw.githubusercontent.com/EyreFree/EFQRCode/master/assets/QRCode7.jpg" alt=""></td>
<td style="text-align:center"><img src="https://raw.githubusercontent.com/EyreFree/EFQRCode/master/assets/QRCode8.jpg" alt="">  </td>
</tr>
</tbody>
</table>
<h2 id="二-示例"><a href="#二-示例" class="headerlink" title="二. 示例"></a>二. 示例</h2><p>执行以下命令：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git <span class="built_in">clone</span> git@github.com:EyreFree/EFQRCode.git; <span class="built_in">cd</span> EFQRCode/Example; pod install; open EFQRCode.xcworkspace</span><br></pre></td></tr></table></figure>
<h2 id="三-环境"><a href="#三-环境" class="headerlink" title="三. 环境"></a>三. 环境</h2><ul>
<li>XCode 8.0+</li>
<li>Swift 3.0+</li>
</ul>
<h2 id="四-安装"><a href="#四-安装" class="headerlink" title="四. 安装"></a>四. 安装</h2><p>EFQRCode 可以通过 <a href="http://cocoapods.org" target="_blank" rel="noopener">CocoaPods</a> 进行获取。只需要在你的 Podfile 中添加如下代码就能实现引入：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">pod &quot;EFQRCode&quot;, &apos;~&gt; 1.2.0&apos;</span><br></pre></td></tr></table></figure>
<h2 id="五-快速使用"><a href="#五-快速使用" class="headerlink" title="五. 快速使用"></a>五. 快速使用</h2><h4 id="1-导入-EFQRCode"><a href="#1-导入-EFQRCode" class="headerlink" title="1. 导入 EFQRCode"></a>1. 导入 EFQRCode</h4><p>在你需要使用的地方添加如下代码引入 EFQRCode 模块：</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> EFQRCode</span><br></pre></td></tr></table></figure>
<h4 id="2-二维码识别"><a href="#2-二维码识别" class="headerlink" title="2. 二维码识别"></a>2. 二维码识别</h4><p>获取图片中所包含的二维码，同一张图片中可能包含多个二维码，所以返回值是一个字符串数组：</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> <span class="keyword">let</span> testImage = <span class="type">UIImage</span>(named: <span class="string">"test.png"</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">let</span> tryCodes = <span class="type">EFQRCode</span>.recognize(image: testImage) &#123;</span><br><span class="line">        <span class="keyword">if</span> tryCodes.<span class="built_in">count</span> &gt; <span class="number">0</span> &#123;</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">"There are <span class="subst">\(tryCodes.<span class="built_in">count</span>)</span> codes in testImage."</span>)</span><br><span class="line">            <span class="keyword">for</span> (index, code) <span class="keyword">in</span> tryCodes.enumerated() &#123;</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">"The content of <span class="subst">\(index)</span> QR Code is: <span class="subst">\(code)</span>."</span>)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">"There is no QR Codes in testImage."</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"Recognize failed, check your input image!"</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="3-二维码生成"><a href="#3-二维码生成" class="headerlink" title="3. 二维码生成"></a>3. 二维码生成</h4><p>根据所输入参数创建各种艺术二维码图片，快速使用方式如下:</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 常用参数:</span></span><br><span class="line"><span class="comment">//                         content: 二维码内容</span></span><br><span class="line"><span class="comment">// inputCorrectionLevel (Optional): 容错率</span></span><br><span class="line"><span class="comment">//                                  L 7%</span></span><br><span class="line"><span class="comment">//                                  M 15%</span></span><br><span class="line"><span class="comment">//                                  Q 25%</span></span><br><span class="line"><span class="comment">//                                  H 30%(默认值)</span></span><br><span class="line"><span class="comment">//                 size (Optional): 边长</span></span><br><span class="line"><span class="comment">//        magnification (Optional): 放大倍数</span></span><br><span class="line"><span class="comment">//                                  (如果 magnification 不为空，将会忽略 size 参数)</span></span><br><span class="line"><span class="comment">//      backgroundColor (Optional): 背景色</span></span><br><span class="line"><span class="comment">//      foregroundColor (Optional): 前景色</span></span><br><span class="line"><span class="comment">//                 icon (Optional): 中心图标</span></span><br><span class="line"><span class="comment">//             iconSize (Optional): 中心图标边长</span></span><br><span class="line"><span class="comment">//       isIconColorful (Optional): 中心图标是否为彩色</span></span><br><span class="line"><span class="comment">//            watermark (Optional): 水印图</span></span><br><span class="line"><span class="comment">//        watermarkMode (Optional): 水印图模式</span></span><br><span class="line"><span class="comment">//  isWatermarkColorful (Optional): 水印图是否为彩色</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 额外参数</span></span><br><span class="line"><span class="comment">//           foregroundPointOffset: 前景点偏移量</span></span><br><span class="line"><span class="comment">//                allowTransparent: 允许透明</span></span><br></pre></td></tr></table></figure>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> <span class="keyword">let</span> tryImage = <span class="type">EFQRCode</span>.generate(</span><br><span class="line">    content: <span class="string">"https://github.com/EyreFree/EFQRCode"</span>,</span><br><span class="line">    magnification: <span class="number">9</span>,</span><br><span class="line">    watermark: <span class="type">UIImage</span>(named: <span class="string">"WWF"</span>),</span><br><span class="line">    watermarkMode: .scaleAspectFill,</span><br><span class="line">    isWatermarkColorful: <span class="literal">false</span></span><br><span class="line">) &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"Create QRCode image success!"</span>)</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"Create QRCode image failed!"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>结果：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1018190-7579f281bbd2d0fd.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="生成示例"></p>
<h2 id="六-使用指南"><a href="#六-使用指南" class="headerlink" title="六. 使用指南"></a>六. 使用指南</h2><p>详情可参见具体使用文档：<a href="https://github.com/EyreFree/EFQRCode/blob/master/README_CN.md" target="_blank" rel="noopener">https://github.com/EyreFree/EFQRCode/blob/master/README_CN.md</a></p>
<h2 id="七-备注"><a href="#七-备注" class="headerlink" title="七. 备注"></a>七. 备注</h2><ol>
<li>请选用对比度较高的前景色和背景色组合；</li>
<li>想要提高生成二维码的清晰度可以选择使用 <code>magnificatio</code> 替代 <code>size</code>，或适当提高它们的数值；</li>
<li>放大倍数过高／边长过大／二维码内容过多可能会导致生成失败；</li>
<li>建议对生成的二维码进行测试后投入使用，例如微信能够扫描成功并不代表支付宝也能成功扫描，请务必根据您的具体业务需要做有针对性的测试；</li>
<li>若有任何问题，期待得到您的反馈，<code>Issue</code> 和 <code>Pull request</code> 都是受欢迎的。</li>
</ol>
<p>备注的备注：好用的话可以给个<code>星星</code>，蟹蟹，QAQ…</p>
<hr>
<p>本文链接：<a href="http://www.eyrefree.org/2017/01/25/2017-01-25-EFQRCode/">http://www.eyrefree.org/2017/01/25/2017-01-25-EFQRCode/</a></p>
<p>如文中无特殊说明，本站均使用以下协议保护：<a href="http://creativecommons.org/licenses/by-nc-nd/3.0/cn/" target="_blank" rel="noopener">署名-非商业性使用-禁止演绎</a></p>

    
  </div>

  
      
<!-- Gitalk评论插件通用代码 -->
<div id="git"></div>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">
<script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script>
<script>
const gitalk = new Gitalk({
  clientID: 'f0ba789df6609f62044d',
  clientSecret: '75f0fc8ccefb72c7c8585ddc2a3f0663e69139f1',
  repo: 'EFGitalk',
  owner: 'EyreFree',
  admin: ['EyreFree'],
  // facebook-like distraction free mode
  distractionFreeMode: false
})
gitalk.render('git')
</script>
<!-- Gitalk代码结束 -->



  

</article>


   
  <div class="text-center donation">
    <div class="inner-donation">
      <span class="btn-donation">支持一下</span>
      <div class="donation-body">
        <div class="tip text-center">给 EyreFree 投食，QAQ</div>
        <ul>
        
          <li class="item">
            
            <img src="/AliPay.png" alt="">
          </li>
        
          <li class="item">
            
            <img src="/WeChat.png" alt="">
          </li>
        
        </ul>
      </div>
    </div>
  </div>


   
  <div class="box-prev-next clearfix">
    <a class="show pull-left" href="/2016/11/24/Coding-Emoji/">
        <i class="icon icon-angle-left"></i>
    </a>
    <a class="show pull-right" href="/2017/02/05/VSCAM/">
        <i class="icon icon-angle-right"></i>
    </a>
  </div>




</div>


  <a id="backTop" class="back-top">
    <i class="icon-angle-up"></i>
  </a>




  <div class="modal" id="modal">
  <span id="cover" class="cover hide"></span>
  <div id="modal-dialog" class="modal-dialog hide-dialog">
    <div class="modal-header">
      <span id="close" class="btn-close">关闭</span>
    </div>
    <hr>
    <div class="modal-body">
      <ul class="list-toolbox">
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/archives/"
              rel="noopener noreferrer"
              target="_self"
              >
              博客
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/category/"
              rel="noopener noreferrer"
              target="_self"
              >
              分类
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/tag/"
              rel="noopener noreferrer"
              target="_self"
              >
              标签
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/project/"
              rel="noopener noreferrer"
              target="_self"
              >
              项目
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/link/"
              rel="noopener noreferrer"
              target="_self"
              >
              友链
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/about/"
              rel="noopener noreferrer"
              target="_self"
              >
              关于
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/atom.xml"
              rel="noopener noreferrer"
              target="_blank"
              >
              RSS
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/search/"
              rel="noopener noreferrer"
              target="_self"
              >
              搜索
            </a>
          </li>
        
      </ul>

    </div>
  </div>
</div>



  
      <div class="fexo-comments comments-post">
    

    
    

    
    

    

    
    

  </div>

  

  <script type="text/javascript">
  function loadScript(url, callback) {
    var script = document.createElement('script')
    script.type = 'text/javascript';

    if (script.readyState) { //IE
      script.onreadystatechange = function() {
        if (script.readyState == 'loaded' ||
          script.readyState == 'complete') {
          script.onreadystatechange = null;
          callback();
        }
      };
    } else { //Others
      script.onload = function() {
        callback();
      };
    }

    script.src = url;
    document.getElementsByTagName('head')[0].appendChild(script);
  }

  window.onload = function() {
    loadScript('/js/bundle.js?235683', function() {
      // load success
    });
  }
</script>

</body>
</html>
